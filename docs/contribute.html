<!DOCTYPE html>
<html lang="en">
<head>
    <title>DockerDoodle | Contribute</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">    
    <link rel="shortcut icon" href="favicon.ico">  
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!-- FontAwesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">   
    <!-- Plugins CSS -->    
    <link rel="stylesheet" href="assets/plugins/prism/prism.css">
    <link rel="stylesheet" href="assets/plugins/lightbox/dist/ekko-lightbox.css">
    <link rel="stylesheet" href="assets/plugins/elegant_font/css/style.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">
    
</head> 

<body class="body-blue">
    <div class="page-wrapper">
        <!-- ******Header****** -->
        <header id="header" class="header">
            <div class="container">
                <div class="branding">
                    <h1 class="logo">
                        <a href="index.html">
                            <span aria-hidden="true" class="icon_documents_alt icon"></span>
                            <span class="text-highlight">Docker</span><span class="text-bold">Doodle</span>
                        </a>
                    </h1>
                </div><!--//branding-->
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item active">Contribute</li>
                </ol>
            </div><!--//container-->
        </header><!--//header-->
        <div class="doc-wrapper">
            <div class="container">
                <div id="doc-header" class="doc-header text-center">
                    <h1 class="doc-title"><span aria-hidden="true" class="icon icon_puzzle_alt"></span> Contribute</h1>
                    <div class="meta"><i class="far fa-clock"></i> Last updated: June 27th, 2019</div>
                </div><!--//doc-header-->
                <div class="doc-body row">
                    <div class="doc-content col-md-9 col-12 order-1">
                        <div class="content-inner">
                            <p>
                                Contributions are always welcome!
                            </p>
                            <p>
                                DockerDoodle is <a class="dotted-line" href="https://github.com/gauravgahlot/dockerdoodle/blob/master/LICENSE" target="_blank">MIT Licensed</a> and accepts contributions via GitHub pull requests. This document outlines some of the conventions on development workflow, commit message formatting, contact points and other resources to make it easier to get your contributions accepted.
                            </p>
                            <p>
                                We gratefully welcome improvements to both, the <strong>documentation</strong> as well as the <strong>code</strong>.
                            </p>
                            <section id="git-clone" class="doc-section">
                                <h2 class="section-title">Getting the Code</h2>
                                <div class="section-block">
                                    <p>To get started contributing to DockerDoodle, you first need to clone the repository by following the below instruction. Please ensure that you have <a href="https://git-scm.com/" target="_blank">Git</a> installed on your local system.
                                    </p>
                                    <p><code>$ git clone https://github.com/gauravgahlot/dockerdoodle.git<br />
                                    $ cd dockerdoodle </code></p>
                                </div>
                            </section><!--//doc-section-->

                            <section id="installation-section" class="doc-section">
                                <h2 class="section-title">Installing Go</h2>
                                <div class="section-block">
                                    <p>Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.
                                    <p>You can install Go by following the steps defined at their <a href="https://golang.org/dl/" target="_blank">download</a> page.</p>                                    
                                </div><!--//section-block-->
                            </section><!--//doc-section-->
                            
                            <section id="getting-packages" class="doc-section">
                                <h2 class="section-title">Getting Packages</h2>
                                <div class="section-block">
                                    <p>
                                        Once you have installed and setup Go, you are ready to install the packages required by the application to run. DockerDoodle uses <a href="https://blog.golang.org/using-go-modules" target="_blank">Go Modules</a> to manage its dependencies. 
                                    </p>
                                    <p>
                                        Module behavior is controlled by an environment variable, <strong>GO111MODULE</strong>, which can be set to <strong>on</strong>, <strong>off</strong> or <strong>auto</strong> (default). When <strong>GO111MODULE</strong> is set to off, the go command maintains the same functionality as in previous versions and uses packages in the <strong>GOPATH</strong> during the build. If <strong>GO111MODULE</strong> is set to on, the go command disregards the <strong>GOPATH</strong> and requires the use of modules instead.
                                    </p>
                                    <p>
                                        We are going to set the <strong>GO111MODULE</strong> as <strong>on</strong>, using the following command:
                                        <p><code>$ export GO111MODULE=on</code></p>
                                        If you are on Windows, use <strong>set</strong> instead of <strong>export</strong>.
                                    </p>
                                    <p>
                                        Using the terminal, navigate to the directory where you have extracted the downloaded file. Now run the following commands to get the dependent packages:
                                        <p><code>$ go build server/main.go<br />
                                        $ go build client/main.go</code></p>
                                        If you don't get any errors, all the dependencies are now available and you are good to go.
                                    </p>
                                </div><!--//section-block-->
                            </section><!--//doc-section-->

                            <section id="docker-hosts" class="doc-section">
                                <h2 class="section-title">Configure Docker Hosts</h2>
                                <div class="section-block">
                                    <p>
                                        To be able to manage the containers running on different hosts, you need to configure the Docker daemon on each host in a certain way. Follow along, execute the steps on each host and it will be easy.
                                    </p>
                                    <div id="pre-reqs"  class="section-block">
                                        <h3 class="block-title">Prerequisites</h3>
                                        <p>Following are the prerequisites on each Docker Host that you want to monitor:</p>
                                        <ul class="list">
                                            <li>Docker is installed on the host</li>
                                            <li>The host can listen for TCP requests</li>
                                            <li>Port <strong>:2375</strong> is available on the host</li>
                                        </ul>
                                    </div><!--//section-block-->

                                    <div id="docker-daemon"  class="section-block">
                                        <h3 class="block-title">Configure Docker Daemon</h3>
                                        <p>
                                            In order to communicate with the Docker daemon on a remote host, you need to make the Docker daemon of the host listen for TCP requests at some port. Here we are going to make the daemon listen at port <strong>:2375</strong>.
                                        </p>

                                        <div class="callout-block callout-warning">
                                            <div class="icon-holder">
                                                <i class="fas fa-exclamation-triangle"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">
                                                <h4 class="callout-title">Important</h4>
                                                <p>
                                                    I'm assuming that your remote hosts are running Unix based system. I also tried to make <strong>Docker for Windows</strong> listen for TCP requests. However, it didn't work out. Here is a <a href="https://github.com/docker/for-win/issues/225">GitHub</a> link which has some good information about the same. 
                                                </p>
                                            </div><!--//content-->
                                        </div><!--//callout-block-->

                                        <p>First, stop the running Docker service with the command:</p>
                                        <p><code>$ sudo service docker stop</code></p>
                                        <p>Open the <strong>docker service</strong> file in an editor and update the value of <strong>ExecStart</strong>. Here is an example of using the <em>nano</em> editor:</p>
                                        <p><code>$ sudo nano /lib/systemd/system/docker.service</code></p>
<pre><code class="language-python">&lt;snip&gt;
    ExecStart=/usr/bin/dockerd -H fd:// -H=tcp://0.0.0.0:2375
&lt;snip&gt;
</code></pre>
                                        <p>Note the <em>tcp://0.0.0.0:2375</em> added in the host list, that the Daemon will connect to. Now, save the file and execute the following commands to restart the Docker daemon:</p>
                                        <p><code>$ sudo systemctl daemon-reload<br />
                                        $ sudo service docker restart</code></p>
                                        <p>If you don't get any errors, it's time to test the configuration.</p>
                                    </div><!--//section-block-->
    
                                    <div id="test"  class="section-block">
                                        <h3 class="block-title">Test Configuration</h3>
                                        <p>
                                            Open a browser and try making a request to the URL: </p>
                                            <p><strong>http://&lt;host-ip&gt;:2375/v1.38/containers/json</strong>.</p>
                                            You should get a <em>json</em> response containing all your containers. If so, you are host is all set.
                                        </p>                                       
                                    </div><!--//section-block-->
                                </div><!--//section-block-->
                            </section><!--//doc-section-->
                                
                            <section id="first-run" class="doc-section">
                                <h2 class="section-title">Running DockerDoodle</h2>
                                <div class="section-block">
                                    <p>
                                        Before you proceed further, please ensure that you are at root of the repository. If so, you must see a <strong>config.json</strong> file with a list of hosts. All you need is to add the Docker hosts (setup above) with their <strong>name</strong> and <stong>IP</strong> address to this list. Note that <strong>name</strong> is for representation purpose only, so you may name the host as it suits your needs. 
                                    </p>
                                    
                                    <div class="code-block">
                                        <h6>Execute the following commands to spin up the server and client:</h6>
                                        <p><code>$ go run server/main.go<br />
                                        $ go run client/main.go</code></p>
                                    </div><!--//code-block-->                                   
                                    <p>
                                        By default the client and server listen at port <strong>:7585</strong> and <strong>:7584</strong> respectively.
                                    </p>
                                </div><!--//section-block-->
                            </section><!--//doc-section-->

                            <section id="protocol-buffers" class="doc-section">
                                <h2 class="section-title">Using Protocol Buffers</h2>
                                <div class="section-block">
                                    <div id="protoc-compiler"  class="section-block">
                                        <h3 class="block-title">Protoc Compiler</h3>
                                        <p>
                                            In case you plan to change the <strong>gRPC</strong> service or <strong>messages</strong>, you will need the <code>protoc</code> compiler. You can download the same from Protocol Buffers <a href="https://github.com/protocolbuffers/protobuf/releases" target="_blank">release page</a>.                                             
                                        </p>
                                        <p>
                                            You also need the <code>protoc-gen-go</code> plugin for the protocol buffer compiler to generate Go code. You can get it with the following command:
                                        </p>
                                        <p><code>$ go get -u github.com/golang/protobuf/protoc-gen-go</code></p>
                                    </div><!--//section-block-->
                                    <div id="compile-changes"  class="section-block">
                                        <h3 class="block-title">Compiling the Changes</h3>
                                        <p>
                                            You can find the existing protobuf messages and RPC services definition under <code>/pkg/pb-messages</code>. You may update the message or service, or may add a completely new protobuf definition based on your requirement.
                                        </p>
                                        <p>
                                            Once you have made the changes in PB messages or RPC service, it's time to compile them and generate the equivalent Go code. Use the following command for the same:
                                        </p>
                                        <p><code>protoc -I ./pkg/pb-messages ./pkg/pb-messages/&lt;changed-file&gt;.proto --go_out=plugins=grpc:./pkg/pb</code></p>
                                    </div><!--//section-block-->
    
                                </div><!--//section-block-->
                            </section><!--//doc-section-->
    
                            <section id="change-ports" class="doc-section">
                                <h2 class="section-title">Change default Ports</h2>
                                <div class="section-block">
                                    <p>
                                        The default ports for the gRPC Client and Server are defined as <strong>ClientPort</strong> and <strong>ServerPort</strong> in <code>/pkg/constants/constants.go</code>. If required, you just need to change the ports here and it will work. 
                                    </p>
                                    <p>
                                        If you change the <strong>ClientPort</strong>, it's is <strong>very</strong> important to update the port used for building the <strong>Web Socket</strong> connection. This web socket connection is used to <strong>push</strong> container stats from the server to the client. Therefore, it's very critical. 
                                    </p>
                                    <p>
                                        To change the port, go to <code>/client/templates/content/host.html</code> and towards the end of the file, you must see:
<pre><code class="language-javascript">&lt;snip&gt;
    window.onload = () => {
        if (window["WebSocket"]) {
          conn = new WebSocket("ws://localhost:7585/ws");
&lt;snip&gt;
</code></pre>
                                        Change the port from <code>:7585</code> to the new value of <strong>ClientPort</strong> and you are good.        
                                    </p>
                                </div><!--//section-block-->
                            </section><!--//doc-section-->
    

                        </div><!--//content-inner-->
                    </div><!--//doc-content-->
                    <div class="doc-sidebar col-md-3 col-12 order-0 d-none d-md-flex">
                        <div id="doc-nav" class="doc-nav">
                            <nav id="doc-menu" class="nav doc-menu flex-column sticky">
                                <a class="nav-link scrollto" href="#git-clone">Getting the Code</a>
                                <a class="nav-link scrollto" href="#installation-section">Installing Go</a>
                                <a class="nav-link scrollto" href="#getting-packages">Getting Packages</a>
                                <a class="nav-link scrollto" href="#docker-hosts">Docker Hosts</a>
                                <nav class="doc-sub-menu nav flex-column">
                                    <a class="nav-link scrollto" href="#pre-reqs">Prerequisites</a>
                                    <a class="nav-link scrollto" href="#docker-daemon">Docker Daemon</a>
                                    <a class="nav-link scrollto" href="#test">Test Configuration</a>
                                </nav><!--//nav-->
                                <a class="nav-link scrollto" href="#first-run">Run DockerDoodle</a>
                                <a class="nav-link scrollto" href="#protocol-buffers">Using Protocol Buffers</a>
                                <nav class="doc-sub-menu nav flex-column">                                    
                                    <a class="nav-link scrollto" href="#protoc-compiler">Protoc Compiler</a>
                                    <a class="nav-link scrollto" href="#compile-changes">Compiling the Changes</a>
                                </nav><!--//nav-->    
                                <a class="nav-link scrollto" href="#change-ports">Change default Ports</a>
                            </nav><!--//doc-menu-->	                        
                        </div>
                    </div><!--//doc-sidebar-->
                </div><!--//doc-body-->              
            </div><!--//container-->
        </div><!--//doc-wrapper-->
        
    </div><!--//page-wrapper-->
    
    <footer class="footer text-center">
        <div class="container">
            <small class="copyright">Theme designed by <a href="https://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a></small>
        </div><!--//container-->
    </footer><!--//footer-->
    
     
    <!-- Main Javascript -->          
    <script type="text/javascript" src="assets/plugins/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/plugins/prism/prism.js"></script>    
    <script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script>  
    <script type="text/javascript" src="assets/plugins/lightbox/dist/ekko-lightbox.min.js"></script>      
    <script type="text/javascript" src="assets/plugins/stickyfill/dist/stickyfill.min.js"></script>                                                              
    <script type="text/javascript" src="assets/js/main.js"></script>
    
</body>
</html> 

